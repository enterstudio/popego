from twisted.application import internet, service
from jq.queue.producerend import QueueFactory

def attachProducersService(port, app, jobsched):
    service =  internet.TCPServer(port, QueueFactory(jobsched))
    service.setServiceParent(app)

def attachConsumersService(port, app, jobsched):
    srv = internet.TimerService(port, jobsched.dispatchPending)
    srv.setServiceParent(app)

application = service.Application("JobQueue Application")

