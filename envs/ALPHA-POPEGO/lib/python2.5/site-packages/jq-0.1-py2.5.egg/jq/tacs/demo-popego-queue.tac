# - asocia con los job consumers que corren en puerto 9000-9003
# - crea el servicio de Queue en puerto 8787
# - Setea un periodo de 1000msec para el despacho de trabajos pendientes
from jq.queue.consumerend import TwistedJobConsumer
from jq.queue_startup import attachProducersService, attachConsumersService, application
from jq.queue.dbsetup import DBSetup

DBSetup().setup("postgres://popego:GranPopego@localhost:5432/PopegoQueue")

from jq.queue.model import JobScheduler
jobScheduler = JobScheduler()

jobScheduler.addConsumer(TwistedJobConsumer('localhost',9000))
jobScheduler.addConsumer(TwistedJobConsumer('localhost',9001))
jobScheduler.addConsumer(TwistedJobConsumer('localhost',9002))

attachProducersService(8787, application, jobScheduler)
attachConsumersService(1000, application, jobScheduler)
